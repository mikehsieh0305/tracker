<!DOCTYPE html>
<html lang="zh-Hant">

<head>
  <meta charset="UTF-8" />
  <title>ç¶ å²©æ¼é›»å…±ç”Ÿ - å·¥ç¨‹è¿½è¹¤</title>
  <link rel="stylesheet" href="../node_modules/frappe-gantt/dist/frappe-gantt.css">
  <style>
    body {
      margin: 0;
      padding: 12px;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: #f5f7fb;
    }

    h1 {
      margin-top: 0;
    }

    .toolbar {
      margin-bottom: 8px;
      display: flex;
      align-items: center;
      flex-wrap: wrap;
      gap: 6px;
    }

    button {
      padding: 6px 12px;
      border-radius: 4px;
      border: none;
      cursor: pointer;
      font-size: 13px;
    }

    .primary {
      background: #4e73df;
      color: #fff;
    }

    .secondary {
      background: #e2e6ea;
    }

    .light {
      background: #f8f9fc;
    }

    #currentFile {
      margin-left: auto;
      font-size: 12px;
      color: #666;
    }

    select {
      padding: 4px 6px;
      font-size: 13px;
    }

    .tabs {
      margin-bottom: 8px;
    }

    .tab-btn {
      padding: 6px 10px;
      border-radius: 4px 4px 0 0;
      border: 1px solid #d1d3e2;
      border-bottom: none;
      background: #e2e6ea;
      cursor: pointer;
      font-size: 13px;
      margin-right: 4px;
    }

    .tab-btn.active {
      background: #fff;
      font-weight: bold;
    }

    .tab-container {
      border: 1px solid #d1d3e2;
      border-radius: 0 6px 6px 6px;
      background: #fff;
      padding: 6px;
      height: calc(100vh - 130px);
      overflow: auto;
    }

    .tab-panel {
      display: none;
    }

    .tab-panel.active {
      display: block;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 12px;
    }

    th,
    td {
      border: 1px solid #ddd;
      padding: 4px 6px;
      text-align: center;
    }

    th {
      background: #f8f9fc;
      position: sticky;
      top: 0;
      z-index: 1;
    }

    input[type="text"],
    input[type="number"],
    input[type="date"] {
      width: 100%;
      box-sizing: border-box;
      border: none;
      outline: none;
      font-size: 12px;
      padding: 2px 4px;
      text-align: center;
      background: transparent;
    }

    /* frappe-gantt bar é¡è‰²å®¢è£½ */
    .gantt .bar.gantt-delay .bar {
      fill: #e74a3b;
    }

    .gantt .bar.gantt-material-risk .bar {
      fill: #f6c23e;
    }

    .gantt .bar.gantt-normal .bar {
      fill: #1cc88a;
    }
  </style>
  <script src="../node_modules/chart.js/dist/chart.umd.js"></script>
  <script src="../node_modules/frappe-gantt/dist/frappe-gantt.umd.js"></script>
</head>

<body>
  <h1>ç¶ å²©æ¼é›»å…±ç”Ÿ - å·¥ç¨‹ / ææ–™ / é˜»ç¤™ è¿½è¹¤</h1>

  <div class="toolbar">
    <button class="primary" id="btnImport">ğŸ“¥ åŒ¯å…¥ Excel</button>

    <span>ä¾†æº Sheetï¼š</span>
    <select id="sheetSelect"></select>

    <button class="light" id="btnAddMaterial">â• æ–°å¢ææ–™åˆ—</button>
    <button class="light" id="btnAddProgress">â• æ–°å¢å·¥ç¨‹åˆ—</button>
    <button class="light" id="btnAddIssue">â• æ–°å¢é˜»ç¤™åˆ—</button>

    <button class="secondary" id="btnExport">ğŸ“¤ åŒ¯å‡º 4 å¼µè¡¨</button>

    <span id="currentFile"></span>
  </div>

  <div class="tabs">
    <button class="tab-btn active" data-tab="material">ææ–™ Material</button>
    <button class="tab-btn" data-tab="progress">å·¥ç¨‹ Progress</button>
    <button class="tab-btn" data-tab="issue">é˜»ç¤™ IssueLog</button>
    <!-- <button class="tab-btn" data-tab="gantt">ç”˜ç‰¹åœ– Gantt</button> -->
    <button class="tab-btn" data-tab="charts">åœ–è¡¨ Charts</button>
  </div>

  <div class="tab-container">
    <!-- Tab 1: Material -->
    <div class="tab-panel active" data-tab-panel="material">
      <table id="materialTable">
        <thead>
          <tr>
            <!-- <th>#</th>
            <th>å€åŸŸ</th>
            <th>Kw</th>
            <th>åŸºæ¨</th>
            <th>æ”¯æ¶å¤§æ–™</th>
            <th>æ”¯æ¶å°æ–™</th>
            <th>æ¨¡çµ„æ¶</th>
            <th>æ¨¡çµ„</th>
            <th>ç‹€æ…‹</th> -->
            <th>#</th>
            <th>å€åŸŸ</th>
            <th>å®¹é‡(kW)</th>
            <th>åŸºæ¨å®Œæˆç‡</th>
            <th>é‹¼æ§‹å¤§æ–™å®Œæˆç‡</th>
            <th>é‹¼æ§‹å°æ–™å®Œæˆç‡</th>
            <th>æ¨¡çµ„å®Œæˆç‡</th>
            <th>é‹¼æ§‹åˆ°æ–™ç‹€æ…‹</th>
            <th>é‹¼æ§‹ç¼ºæ–™èªªæ˜</th>
            <th>ææ–™ç‹€æ…‹</th>
            <th>ææ–™å‚™è¨»</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>

    <!-- Tab 2: Progress -->
    <div class="tab-panel" data-tab-panel="progress">
      <table id="progressTable">
        <thead>
          <tr>
            <!-- <th>#</th>
            <th>å€åŸŸ</th>
            <th>å·¥é …</th>
            <th>èµ·å§‹</th>
            <th>é è¨ˆå®Œå·¥</th>
            <th>ç¾æ³</th>
            <th>ç‹€æ…‹ç‡ˆè™Ÿ</th> -->
            <th>#</th>
            <th>å€åŸŸ</th>
            <th>å®¹é‡(kW)</th>
            <th>å·¥é …</th>
            <th>æ–½å·¥èµ·å§‹æ—¥</th>
            <th>é è¨ˆå®Œå·¥æ—¥æœŸ</th>
            <th>é™³æŠ—å½±éŸ¿æœŸé–“</th>
            <th>é™³æŠ—å¯¦éš›å½±éŸ¿å¤©æ•¸</th>
            <th>ç¾æ³èªªæ˜</th>
            <th>å·¥æœŸç‹€æ…‹</th>
            <th>ç‹€æ…‹ç‡ˆè™Ÿ</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>

    <!-- Tab 3: IssueLog -->
    <div class="tab-panel" data-tab-panel="issue">
      <table id="issueTable">
        <thead>
          <tr>
            <!-- <th>#</th>
            <th>å€åŸŸ</th>
            <th>å•é¡Œ</th>
            <th>ç™¼ç”Ÿæ—¥</th>
            <th>å½±éŸ¿</th>
            <th>è¨­è¨ˆè®Šæ›´</th>
            <th>ç‹€æ…‹</th> -->
            <th>#</th>
            <th>å€åŸŸ</th>
            <th>å®¹é‡(kW)</th>
            <th>å•é¡Œé¡å‹</th>
            <th>å•é¡Œç™¼ç¾æ—¥æœŸ</th>
            <th>å•é¡Œå…§å®¹</th>
            <th>å½±éŸ¿æœŸé–“</th>
            <th>å¯¦éš›å½±éŸ¿å¤©æ•¸</th>
            <th>å½±éŸ¿èªªæ˜</th>
            <th>æ”¹å–„æªæ–½</th>
            <th>åœ°ä¸»/é¤Šæ®–æˆ¶è¯çµ¡æ–¹å¼</th>
            <th>GRçª—å£</th>
            <th>ç‹€æ…‹</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>

    <!-- Tab 4: Charts -->
    <div class="tab-panel" data-tab-panel="charts">
      <div style="display:flex; gap:16px; flex-wrap:wrap;">
        <div style="flex:1 1 400px; min-width:350px;">
          <h3>å„å€åŸŸå®¹é‡ (kW)</h3>
          <canvas id="areaCapacityChart"></canvas>
        </div>
        <div style="flex:1 1 400px; min-width:350px;">
          <h3>ææ–™ç‹€æ…‹åˆ†ä½ˆ</h3>
          <canvas id="materialStatusChart"></canvas>
        </div>
      </div>
    </div>

    <!-- Tab 5: Gantt -->
    <!-- <div class="tab-panel" data-tab-panel="gantt">
      <div id="ganttContainer" style="width:100%; height: calc(100vh - 180px);"></div>
    </div> -->

  </div>

  <script type="module" src="renderer.js"></script>
</body>

</html>